<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.green.gogiro.butchershop.ButcherShopMapper">

    <select id="selButcherShopAll">
        SELECT ibutcher, name, location, x, y
        FROM t_butcher_shop
        LIMIT #{startIdx}, #{rowCount}
    </select>

    <select id="selButcherShopPics">
        SELECT ibutcher, pic
        FROM t_butcher_pic
        WHERE ibutcher in (
        <foreach collection="pk" item="ibutcher"  separator=",">
            #{ibutcher}
        </foreach>
        )
    </select>

    <insert id="insButcherReview" useGeneratedKeys="true" keyProperty="ireview">
        INSERT INTO t_but_review
        SET iuser = #{iuser}
        , ibutcher = #{ibutcher}
        , star = #{star}
        , review = #{review}
    </insert>

    <insert id="insButcherReviewPic">
        INSERT INTO t_but_review_pic
        (ireview,pic)
        VALUES
            <foreach collection="pics" item="pic" open="(" close=")" separator="),( ">
                #{ireview}, #{pic}
            </foreach>
    </insert>
</mapper>